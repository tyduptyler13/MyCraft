'use strict';var marchY=function(b){for(var h=[],l=null,d=0;16>d;++d){if(0!==d)for(var m=0,k=0,n=b[d].length;k<n;++k){var e=b[d][k];if(0===l.length)e.y=d,e.yLen=1,h.push(e);else for(var p=m,f=l.length;p<f;++p){var a=l[p];if(e.x<a.x&&e.z<a.z){e.y=d;e.yLen=1;h.push(e);break}else if(e.x>a.x&&e.z>a.z)m=p;else if(e.x===a.x&&e.xLen===a.xLen&&e.z===a.z&&e.zLen===a.zLen&&e.type===a.type){null!==a.y?a.yLen++:(a.y=d-1,a.yLen=2,h.push(a));b[d][k]=a;break}}}else 0===b[d+1].length&&(h=h.concat(b[d].map(function(a){a.y=
0;a.yLen=1;return a})));l=b[d]}return h},marchZ=function(b){for(var h=[],l=[],d=null,m=0;256>m;++m){var k=m%16;if(0!==k)for(var n=0,e=0,p=b[m].length;e<p;++e){var f=b[m][e];if(0===d.length)f.z=k,f.zLen=1,l.push(f);else for(var a=n,g=d.length;a<g;++a){var c=d[a];if(f.x<c.x){f.z=k;f.zLen=1;l.push(f);break}else if(f.x>c.x)n=a;else if(f.x===c.x&&f.xLen===c.xLen&&f.type===c.type){null!==c.z?c.zLen++:(c.z=k-1,c.zLen=2,l.push(c));b[m][e]=c;break}}}else 0===b[k+1].length&&(h=h.concat(b[k].map(function(a){a.z=
0;a.zLen=1;return a})));15===k?(d=null,h.push(l),l=[]):d=b[m]}return h},marchX=function(b){for(var h=[],l=[],d=null,m=0,k=0;4096>k;++k){var n=k%16;b[k]!==d&&(null!==d&&l.push({type:d,x:m,y:null,z:null,xLen:n-m,yLen:null,zLen:null}),m=n,d=b[k]);15===n&&(l.push({type:d,x:m,y:null,z:null,xLen:n-m+1,yLen:null,zLen:null}),h.push(l),l=[],d=null,m=0)}h.forEach(function(b,d,f){f[d]=b.filter(function(a){return 0>a.type?!1:!0})});return h},generate=function(b){for(var h=new Float32Array(108*b.length),l=[],
d=new Float32Array(108*b.length),m=new Float32Array(72*b.length),k=[0,2,1,2,3,1,4,6,5,6,7,5,4,5,1,5,0,1,7,6,2,6,3,2,5,7,0,7,2,0,1,3,4,3,6,4],n=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]].reduce(function(a,b){return a.concat(b,b,b,b,b,b)},[]),e=0,p=b.length;e<p;++e){for(var f=b[e],a=f.xLen+f.x,g=f.yLen+f.y,c=f.zLen+f.z,q=f.x,r=f.y,t=f.z,a=[[a,g,c],[a,g,t],[a,r,c],[a,r,t],[q,g,t],[q,g,c],[q,r,t],[q,r,c]],g=0,c=k.length;g<c;++g)h[3*g+108*e]=a[k[g]][0],h[3*g+108*e+1]=a[k[g]][1],h[3*g+108*e+2]=
a[k[g]][2];d.set(n,108*e);a=f.xLen;g=f.yLen;c=f.zLen;m.set([0,g,0,0,c,g,0,0,c,0,c,g,0,g,0,0,c,g,0,0,c,0,c,g,0,c,0,0,a,c,0,0,a,0,a,c,0,c,0,0,a,c,0,0,a,0,a,c,0,g,0,0,a,g,0,0,a,0,a,g,0,g,0,0,a,g,0,0,a,0,a,g],72*e);l.push(f.type)}b={position:h.buffer,materialIndex:Uint8Array.from(l).buffer,normals:d.buffer,uvs:m.buffer};self.postMessage(b,[b.position,b.materialIndex,b.normals,b.uvs])};
self.addEventListener("message",function(b){b=new Int8Array(b.data);for(var h=!1,l=0;4096>l;++l)if(0<=b[l]){h=!0;break}h?generate(marchY(marchZ(marchX(b)))):generate([])});
